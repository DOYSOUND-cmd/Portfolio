/* =========================================================
   Welcome Overlay — Flashy+ (長め表示 / シャイン&回転なし / 強グリッチ)
   ========================================================= */

#welcome{
  position: fixed; inset: 0; z-index: 9999;
  display:grid; place-items:center;
  background: radial-gradient(1200px 800px at 50% -12%, #1b2a40, transparent 58%), #0b0f16;
  overflow:hidden; isolation:isolate;
  color:#e6edf3;
}
#welcome.hidden{ display:none; }

/* 背景 Canvas 群（粒子/コンフェッティ） */
.w-canvas{ position:absolute; inset:0; width:100%; height:100%; }

/* 光学系レイヤー（フレア/虹色コニック）— 左右移動/回転アニメなし */
.w-overlay{
  position:absolute; inset:-12%;
  pointer-events:none;
  mix-blend-mode: screen;
  background:
    radial-gradient(900px 560px at 50% -18%, #84e8ff18 0%, transparent 60%),
    conic-gradient(from 200deg at 50% 10%,
      #ff00ff10, #00e5ff10, #00ff8c10, #ffd40010, #ff00ff10);
  filter: saturate(1.2) blur(.2px);
}

/* スキャンライン＋グレイン（疑似ノイズ） */
.w-overlay::before{
  content:"";
  position:absolute; inset:-2%;
  background: repeating-linear-gradient(0deg, #0006 0 2px, transparent 2px 4px);
  opacity:.14;
  mix-blend-mode: soft-light;
}
.w-overlay::after{
  content:"";
  position:absolute; inset:0;
  background-image:
    url("data:image/svg+xml;utf8,\
    <svg xmlns='http://www.w3.org/2000/svg' width='80' height='80' viewBox='0 0 80 80'>\
      <filter id='f'><feTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='1' stitchTiles='stitch'/></filter>\
      <rect width='100%' height='100%' filter='url(%23f)' opacity='0.08'/>\
    </svg>");
  background-size: 140px 140px;
  mix-blend-mode: overlay;
  opacity:.35;
  animation: grain 1.6s steps(2) infinite;
}
@keyframes grain { to { transform: translate3d(1px, -1px, 0); } }

/* 中央テキスト群 */
.w-inner{
  position:relative; z-index:2;
  text-align:center; display:flex; flex-direction:column; align-items:center; gap: 12px;
  padding: 16px;
}
.w-title{
  margin:0; line-height: 1;
  font-weight: 1000;
  letter-spacing: .14em;
  font-size: clamp(42px, 12vw, 132px);
  position: relative;
  filter: drop-shadow(0 0 14px #ffffff14);
  will-change: filter, transform, opacity;
  text-shadow: 0 0 0 rgba(0,0,0,0);
}

/* 1文字 span（JS で挿入） */
.w-char{
  display:inline-block;
  opacity:0; transform: translateY(18px) scale(.98);
  filter: blur(6px);
  will-change: transform, opacity, filter;
}

/* 強グリッチ（色分離＋揺れ＋スケール） */
.w-title.glitch{
  animation: glitchBurst .12s steps(2) 0s 10; /* 強め・短パルス連射 */
}
@keyframes glitchBurst{
  0%   { text-shadow: 6px 0 #ff2ea6, -6px 0 #00eaff; transform: translateX(0.6px) scale(1.006); }
  25%  { text-shadow: -7px 0 #ff2ea6, 7px 0 #00eaff; transform: translateX(-0.6px) scale(0.996); }
  50%  { text-shadow: 5px 0 #ff2ea6, -5px 0 #00eaff; transform: translateX(0.5px) scale(1.004); }
  75%  { text-shadow: -8px 0 #ff2ea6, 8px 0 #00eaff; transform: translateX(-0.7px) scale(0.994); }
  100% { text-shadow: 0 0 #ff2ea6, 0 0 #00eaff; transform: translateX(0) scale(1); }
}

.w-sub{
  color:#a8bad0; font-weight:800; letter-spacing:.1em;
  font-size: clamp(12px, 2.8vw, 18px);
  opacity:0; transform: translateY(8px);
}

/* フェードアウト */
#welcome.fade-out{ animation: w-fade .42s ease forwards; }
@keyframes w-fade { to { opacity:0; } }

/* 低モーション配慮 */
@media (prefers-reduced-motion: reduce){
  .w-overlay{ animation: none; }
  .w-title.glitch{ animation: none; text-shadow: none; }
}

/* iOS svh for full-height overlay */
@supports (height: 100svh){
  #welcome{ height: 100svh; }
}
/* iOS safe-area insets (no visual change on desktop) */
#welcome{ padding-top: max(0px, env(safe-area-inset-top)); padding-bottom: max(0px, env(safe-area-inset-bottom)); }
