<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tube Clean Booster — Product Detail</title>
  <meta name="description" content="9V駆動でボードに載せやすい真空管クリーンブースターの紹介。" />
  <!-- 共通スタイル -->
  <link rel="stylesheet" href="../styles/site-core.css" />
  <!-- プロダクト詳細 共通スタイル -->
  <link rel="stylesheet" href="../styles/project-detail.css" />
  <style>
    /* 3Dビューア用の補助スタイル（project-detail.css に干渉しない範囲で上書き） */
    .pd-3d { display: grid; gap: clamp(12px, 2vw, 16px); }
    .pd-3d__stage {
      position: relative; width: 100%; aspect-ratio: 16/9;
      background: #0f141d; border: 1px solid #00000055; border-radius: 10px; overflow: hidden;
    }
    .pd-3d__canvas { position: absolute; inset: 0; width: 100%; height: 100%; display: block; border: 0; }
    .pd-3d__hint { color: var(--muted); font-size: .95rem; }
    .pd-3d__toolbar { display: flex; gap: 8px; flex-wrap: wrap; align-items: center; }
    .pd-3d__loading{
      position:absolute; inset:0;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      gap: clamp(6px, 1vw, 12px);
      background: rgba(10, 15, 24, 0.82);
      color:#f5f7fb; font-weight:700; text-transform:uppercase; letter-spacing:.08em;
      font-size:.9rem;
      opacity:0; pointer-events:none;
      transition: opacity .35s ease;
    }
    .pd-3d__loading.is-active{ opacity:1; }
    .pd-3d__spinner{
      width:42px; height:42px;
      border-radius:50%;
      border:3px solid rgba(255,255,255,.18);
      border-top-color:#6be7ff;
      animation: pd-3d-spin 1s linear infinite;
    }
    .pd-3d__text{ font-size:.8rem; }
    @keyframes pd-3d-spin{
      to{ transform: rotate(360deg); }
    }
  </style>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-S29JRMXN8G"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-S29JRMXN8G');
  </script>
</head>
<body>

  <!-- Product Hero -->
  <header class="pd-hero">
    <div class="container">
      <div class="pd-hero__eyebrow">Product Detail</div>
      <h1 class="pd-hero__title">真空管クリーンブースター</h1>
      <p class="pd-hero__lede">
        真空管ならではの自然な倍音とレンジ感を、エフェクトボード前提の<strong>9V駆動</strong>で実現。<br>
        回路はKiCadで設計し、アルミケースを穴あけ加工・フェイクレザーで外装仕上げ。プリント基板も発注して組み上げました。
      </p>

      <!-- アイコン付きタグ -->
      <ul class="pd-badges pd-badges--icons" aria-label="使用技術">
        <li class="badge">
          <img class="badge__icon" src="../assets/icons/electronic_circuit.jpg" alt="" width="18" height="18" loading="lazy" decoding="async">
          <span>electronic circuit</span>
        </li>
        <li class="badge">
          <img class="badge__icon" src="../assets/icons/CAD.jpg" alt="" width="18" height="18" loading="lazy" decoding="async">
          <span>CAD</span>
        </li>
      </ul>

      <div class="pd-cta">
        <a class="btn" href="../index.html">Topへ戻る</a>
      </div>
    </div>
  </header>

  <!-- ===== Main ===== -->
  <main id="main">

    <!-- 概要 -->
    <section class="pd-section" aria-labelledby="about-title">
      <div class="container">
        <h2 id="about-title" class="pd-section__title">概要</h2>
        <div class="pd-summary">
          <p>
            　真空管エフェクターは高電圧駆動が一般的ですが、本機は9V駆動を前提に設計し、ボードでの取り回しを重視しています。<br>
            　回路はクリーンブーストを主眼に、位相ズレやノイズ対策を含めてシンプルに最適化しました。
          </p>
        </div>
      </div>
    </section>

    <!-- 外観（1枚を中央寄せ） -->
    <section class="pd-section" aria-labelledby="ex-title">
      <div class="container">
        <h2 id="ex-title" class="pd-section__title">外観</h2>
        <div class="pd-shots pd-shots--single" data-gallery>
          <figure class="pd-shot">
            <img src="../assets/work_tube_booster.jpg" alt="真空管クリーンブースターの外観" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>9V駆動・ペダルボード前提の筐体設計</figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- 3D Model Viewer（筐体GLB） -->
    <section class="pd-section" aria-labelledby="viewer-title">
      <div class="container">
        <h2 id="viewer-title" class="pd-section__title">3D Scan Viewer</h2>
        <div class="pd-3d">
          <div class="pd-3d__stage" id="glb-stage">
            <canvas
              id="glb-canvas"
              class="pd-3d__canvas"
              data-type="glb"
              data-src="../assets/Effector/Effector.glb"
              data-autoRotate="true"
              data-rotationSpeed="0.35"
              data-exposure="1.75"
              data-yaw="30"
              data-pitch="20"
              aria-label="3Dモデルビューア（筐体GLB）"
            ></canvas>
          </div>
          <div class="pd-3d__toolbar">
            <button class="btn" data-role="toggle-rotate" data-target="#glb-canvas">再生/停止</button>
            <button class="btn" data-role="reset-view"  data-target="#glb-canvas">リセット</button>
            <span class="pd-3d__hint">ドラッグで回転・ホイールで拡大縮小</span>
          </div>
        </div>
      </div>
    </section>

    <!-- 回路設計（図＋ GLBビューア） -->
    <section class="pd-section" aria-labelledby="circuit-title">
      <div class="container">
        <h2 id="circuit-title" class="pd-section__title">回路設計</h2>

        <div class="pd-shots pd-shots--single">
          <figure class="pd-shot">
            <img src="../assets/TubeEffector_circuit.png" alt="回路図（KiCad）" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>KiCadで回路図作成</figcaption>
          </figure>
        </div>

        <div class="pd-3d" style="margin-top:14px">
          <div class="pd-3d__stage" id="circuit-stage">
            <canvas
              id="circuit-canvas"
              class="pd-3d__canvas"
              data-type="glb"
              data-src="../assets/tube_effector.glb"
              data-autoRotate="true"
              data-rotationSpeed="0.35"
              data-exposure="1.75"
              data-yaw="30"
              data-pitch="20"
              aria-label="3Dモデルビューア（回路GLB）"
            ></canvas>
          </div>
          <div class="pd-3d__toolbar">
            <button class="btn" data-role="toggle-rotate" data-target="#circuit-canvas">再生/停止</button>
            <button class="btn" data-role="reset-view"  data-target="#circuit-canvas">リセット</button>
            <span class="pd-3d__hint">ドラッグで回転・ホイールで拡大縮小</span>
          </div>
        </div>

      </div>
    </section>

    <!-- ケース製作 -->
    <section class="pd-section" aria-labelledby="case-title">
      <div class="container">
        <h2 id="case-title" class="pd-section__title">ケース製作</h2>
        <div class="pd-shots" data-gallery>
          <figure class="pd-shot">
            <img src="../assets/TubeEffector_Process1.jpg" alt="ケース加工：穴あけ" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>アルミケースをドリル盤で加工</figcaption>
          </figure>
          <figure class="pd-shot">
            <img src="../assets/TubeEffector_Process2.jpg" alt="外装仕上げ：フェイクレザー" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>外装はフェイクレザーで仕上げ</figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- 配線 -->
    <section class="pd-section" aria-labelledby="wiring-title">
      <div class="container">
        <h2 id="wiring-title" class="pd-section__title">配線</h2>
        <div class="pd-shots" data-gallery>
          <figure class="pd-shot">
            <img src="../assets/TubeEffector_substrate.jpg" alt="基板実装" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>プリント基板を発注・実装</figcaption>
          </figure>
          <figure class="pd-shot">
            <img src="../assets/TubeEffector_wiring.jpg" alt="筐体への配線" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>筐体への配線：整線と固定</figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- 試奏動画 -->
    <section class="pd-section" aria-labelledby="video-title">
      <div class="container">
        <h2 id="video-title" class="pd-section__title">試奏動画</h2>
        <div class="pd-shots pd-shots--single">
          <figure class="pd-shot">
            <div style="position:relative; width:100%; aspect-ratio:16/9; background:#0f141d; border-radius:8px; overflow:hidden; border:1px solid #00000055;">
              <iframe
                src="https://www.youtube.com/embed/4u2E2e-8ty4?si=1nFFWHFCgCdBIkIA"
                title="YouTube試奏動画"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                allowfullscreen
                style="position:absolute; inset:0; width:100%; height:100%; border:0;"
              ></iframe>
            </div>
            <figcaption>音量の持ち上がりと中域の押し出しを確認</figcaption>
          </figure>
        </div>
      </div>
    </section>

    <!-- スペクトル解析 -->
    <section class="pd-section" aria-labelledby="spectrum-title">
      <div class="container">
        <h2 id="spectrum-title" class="pd-section__title">スペクトル解析</h2>
        <div class="pd-shots" data-gallery>
          <figure class="pd-shot">
            <img src="../assets/tube_off.png" alt="直アンプ時のスペクトル" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>直アンプ時のスペクトル</figcaption>
          </figure>
          <figure class="pd-shot">
            <img src="../assets/tube_on.png" alt="ブースター有効時のスペクトル" width="1280" height="720" loading="lazy" decoding="async">
            <figcaption>ブースター有効時：中域が前に出る傾向</figcaption>
          </figure>
        </div>
      </div>
    </section>

  </main>

  <!-- 詳細ページ用スクリプト -->
  <script src="../scripts/project-detail.js" type="module"></script>

  <!-- Three.js（同一バージョンを使用） -->
  <script src="https://unpkg.com/three@0.147.0/build/three.min.js"></script>
  <script src="https://unpkg.com/three@0.147.0/examples/js/controls/OrbitControls.js"></script>
  <script src="https://unpkg.com/three@0.147.0/examples/js/loaders/GLTFLoader.js"></script>

  <!-- 共通 3D 初期化 -->
  <script src="../scripts/project-3d-viewer.js" type="module"></script>
</body>
</html>
